## 확률형 광고 모델 알고리즘
* 이번 프로젝트의 주요 수익 모델은 확률형 광고이다.
* 머신러닝을 활용한 가게 추천시스템과는 거리가 멀지만,
* 확률을 이용해서 순수하게 가게 추천을 구현하였다.

## 광고 노출 전략 및 횟수
* 광고를 등록한다면 기본적으로 1000건의 노출을 해준다.
* 광고를 등록해 노출횟수(=impression이라 칭하겠다.)가 1이상이면
* 노출목록에 포함이 된다.
* count 쿼리를 이용해 impression이 1이상인 데이터의 수를 긁어온다.
* 그리고 데이터베이스에 id가 시작하는 1부터 가져온 데이터의 갯수만큼의 범위에서 하나의 id를 뽑는다.
* 그리고 그 id를 상점 서비스에 리턴하여 최상단에 추가되게한다.
* 그렇게 노출이 된 광고는 impression을 -1 하여준다.

## 상세 설명
### 확률 알고리즘
* db에 등록된 상점들 중에서 남은 노출횟수(impression)가 
* 0 초과인 경우의 데이터들을 count 쿼리를 이용해 수를 뽑아온다.
* 이를 통해서 자바의 Random을 이용해서 1부터 카운트 한 값까지의 수까지 무작위로 하나를 뽑는다.
* 이러한 알고리즘은 algorithm이라는 디렉터리 안의 RecommendAlgorithm 클래스 내부에 기술되어 있다.
### 광고횟수가 0일때
* 만약 노출 횟수를 다채워 0이 되었을때 등록된 상점의 삭제는 굳이 하지 않는다.
* 또한 주인 회원은 나의 광고에서 횟수를 확인할 수 있고, 더 결제하여 사용할 수 있다.
### 고민점
* 추천을 할때마다 count 쿼리를 날리는 것은 비효율적이라는 생각이 들 수도 있다.
* 그러나 이것을 해결하려면 캐쉬를 써야한다.
* redis같은 캐쉬를 등록하고 연결해서 사용하는것이 더욱 느리고, 오버 엔지니어링이라 판단되었다.
* 따라서 count쿼리의 성능을 최적화 하는 방법을 선택했다.
* 이것에 대해서는 [count 쿼리 성능 최적화](https://github.com/liveforone/middle/blob/master/Documents/COUNT_QUERY_OPTIMIZATION.md)에서 볼 수 있다.